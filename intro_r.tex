% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={An illustrated introduction to R},
  pdfauthor={Hari Subhash},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{An illustrated introduction to R}
\author{Hari Subhash}
\date{2021-06-16}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

This page currently holds my best practices and thoughts about while writing this book. This page eventually will be similar to other pages such as \href{https://adv-r.hadley.nz/}{Advanced R}.

\textbf{Rendering}
The current rendering style is pretty basic. However, once the book is completed, I will switch to a style similer to Advanced R. The output.yml from the advanced R book or try the Advanced R solutions.

\textbf{Writing process}
My current writing process with an emphasis on adding citations.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Write using markdown first. Note in plain text the citations.
\item
  Capture all citations in zotero
\item
  Once the first draft of a chapter is complete, switch to the visual editor and use the \citep{6functi} syntax to add all the citations.
\end{enumerate}

This book will introduce R\ldots{}

Pre-requisites

This book is meant for those with no familiarity with R. You don't need to know how to code have any familiarity with programming in general. The only pre-requisites are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Some familiarity with computers for basic tasks like installing new software.
\item
  Commitment towards trying things on your own (even when it gets hard).
\end{enumerate}

I want to stress the second point. This will book will try to make things really easy and intuitive. But there will be times when you encounter an error or issue that is not covered here. You should reach out on the community discord channel or

\hypertarget{setup}{%
\chapter{Setup R and RStudio}\label{setup}}

In this chapter, we will install R and RStudio and get familiar with executing some code.

\hypertarget{install-r}{%
\section{Install R}\label{install-r}}

Our very first step is to download and install R. The sequence below is current as of August 2021. \href{https://cran.r-project.org/}{CRAN}, which is an open repository for R content, hosts installation files for R across different servers located around the world. I am based out of the US so I will pick one from here but you could use any of the options here to download R. On the next screen, pick the version that corresponds to your operating system and install it on your machine.

\includegraphics{assets/ch_1-setup/gifs/download_r.gif}

Once R is installed on your computer, your machine would be able to understand and execute any code that you write in R.

\hypertarget{install-rstudio}{%
\section{Install RStudio}\label{install-rstudio}}

R comes with a basic editor for writing code. But we won't use it in this book. Instead we will use RStudio.

You can think of R Studio as a fully featured editor like Microsoft Word or Google docs, while the basic editor that ships with R is like the notepad or any other basic text editor. The community version of RStudio is free and packed with features that make our lives easier.

You can download RStudio from the following \href{https://www.rstudio.com/products/rstudio/download/\#download}{link}. Once you have R Studio installed, open it up to write your first few lines of code.

\hypertarget{run-commands-in-the-console}{%
\section{Run commands in the console}\label{run-commands-in-the-console}}

Let's print(``hello world'') as our first command.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\StringTok{"Hello World!"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The right angle bracket with blinking cursor shows the place where we can enter commands. You should follow along with the next sequence of steps so that you get familiar with typing commands in R.

\includegraphics{assets/ch_1-setup/gifs/hello_world.gif}

Let's try out a few basic arithmetic operations. Enter the arithmetic as shown below one line at a time.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{+} \DecValTok{2}
\DecValTok{320} \SpecialCharTok{*} \DecValTok{987}
\DecValTok{10} \SpecialCharTok{\textgreater{}} \DecValTok{12}
\end{Highlighting}
\end{Shaded}

You can think of the R console as a calculator on steroids. Similar to the calculator it allows us to enter commands and it prints the results of those below the command.

\includegraphics{assets/ch_1-setup/gifs/console.gif}

\hypertarget{dealing-with-errors}{%
\section{Dealing with errors}\label{dealing-with-errors}}

Computers, unlike humans are extremely finicky and precise about language. While humans can infer meaning from jumbled up words or incomplete sentences; computers will protest and complain even if a period is not where it is supposed to be. This means that at some point we will invariably type in something that yields an error. When that happens R will return an error message like the one shown below that indicates why there was an issue with executing a particular line of code.

\includegraphics{assets/ch_1-setup/gifs/an_error.gif}

Errors can be frustrating experience if you are new to coding. You might not immediately be able to tell why an error occurred and the error message from R can often seem very cryptic.

Errors, however, are a part and parcel of programming. And a big component of your journey as a new programmer will be to learn how to understand and resolve them. The first and often best strategy is to copy paste the error message and search on google to see if others have resolved the same error with someone else. Initially even these solutions like those on forums like \href{https://stackoverflow.com/questions/14469486/r-issue-object-not-found}{stackoverflow} might seem hard to decipher and understand. But, eventually you will get to a point where you are not as flustered when you encounter them and have enough knowledge, tools and strategies in your arsenal to troubleshoot effectively. You might even come to enjoy the puzzle solving learning experience that an odd error brings 😄.

I will deliberately introduce several errors as we go through this book to get us familiarized with them and teach you how to go about resolving them.

\hypertarget{saving-code}{%
\section{Saving code}\label{saving-code}}

So far, we have typed commands into the console. But you will notice that there is no option to save the code that we have typed into the console. Most projects would require files that can be saved so that we can work on them over a period of time and execute them a multiple times without having to type them out each time.

We can do this by placing code inside a file. There are many different types of files but, for now let's start with a simple R script.

\includegraphics{assets/ch_1-setup/gifs/new_file.gif}

Now we need to get all the commands that we tried out earlier into this script. One option would be retype all the commands but that is an extremely tedious way of doing this. Instead, we can access all the previously executed code using the history tab as shown below and copy it over to the source file.

\includegraphics{assets/ch_1-setup/gifs/history.gif}

We don't need the line that generated the error, so let's remove that and save the file. I am calling it my\_first\_script. But you can call it anything you want.

\includegraphics{assets/ch_1-setup/gifs/save_file.gif}

The files tab in RStudio shows all your files and folders. Navigate to the folder you saved the script in to check if it is actually there.

\includegraphics{assets/ch_1-setup/gifs/saved_file.gif}

\hypertarget{executing-a-script}{%
\section{Executing a script}\label{executing-a-script}}

Once you have saved your file, you can run it as many times you would like without having to retype any of the commands. There are two ways you can do this. The first is by stepping through the script one line at a time using the run button.

\includegraphics{assets/ch_1-setup/gifs/run_lines.gif}

The second is by running the full script by sourcing the file. You can do this by clicking on the source button. Notice that the source command generates a new line in the history tab. This is the command that is used to source a file. Now we can close the script and paste this command from the history tab using the \texttt{To\ console} button and run it to execute all of the code within that script as shown below. Also notice how I use the broom 🧹 icon to clear the code in the console before sourcing the script.

\includegraphics{assets/ch_1-setup/gifs/run_file.gif}

\hypertarget{rstudio-look-and-feel}{%
\section{RStudio look and feel}\label{rstudio-look-and-feel}}

RStudio comes with tons of options to customize how it looks and feels. You can customize the different tabs, choose a different font, apply a darker theme etc. I personally like a dark theme, so I am going to switch over to that for the rest of this book.

\includegraphics{assets/ch_1-setup/gifs/dark.gif}

\hypertarget{functions-intro}{%
\chapter{Introduction to Functions}\label{functions-intro}}

In chapter \ref{setup} section on \protect\hyperlink{saving-code}{saving code} we saw how we could save a series of programming commands in a script and then source that script whenever we needed to execute the same sequence. This meant that we did not have to type out the commands again to execute the series of steps, instead, we could simply source the script to run the sequence of steps for us.

Functions are a similar concept in programming but with the additional feature of being able to pass certain values as arguments that determine the nature of the output.

For instance, consider the following function \texttt{sum(32,\ 15)}. \texttt{sum} is the name of the function and \texttt{32} and \texttt{15} are the arguments that were passed to the function. If we changed the values of the arguments to some other numbers then the output of the sum function would change accordingly.

We'd similarly used the \texttt{print} function earlier with the argument \texttt{"Hello\ World"}. In programming terminology, whenever we use a function in our code it is referred to as being called with its arguments. Here we called the function print with the argument ``Hello World''.

\includegraphics{assets/ch_3-functions/gifs/functions_syntax.gif}

Functions are an extremely powerful tool for programming and have a lot of different benefits.

Well named functions enhance the readability of your code by declaring to the reader what it is that you are doing. When a programmer uses functions like \texttt{sum} or \texttt{print}, the reader clearly understands what they are seeking to achieve. This is in contrast with a series of commands that implement the nitty-gritty details of adding two numbers or printing something to the console, which often are confusing to someone else who is not necessarily familiar with the logic behind the detailed steps.

By encapsulating a series of steps in a function, you also reduce the likelihood errors that could occur if you had to copy and paste the same set of commands in different places in your code. Eliminating the need to copy paste commands also makes your code much easier to manage, since if you realize you have to modify a particular command you only have to do it within the function definition, whereas if you did not use a function, you would have to find all the places where that command appears and then change all those instances.

\hypertarget{an-illustration}{%
\section{An illustration}\label{an-illustration}}

Let's explore why functions are useful and how to go about building them by teaching a computer to make tea. Imagine this computer is sending these instructions to a robot.

Now, asking your computer to make tea is very different from say asking a friend of yours to make you tea.

Your friend doesn't need step by step instructions to make tea. In fact your friend would probably think that you were crazy if you told them something like ``put the kettle on the stove and wait for the water to come to a boil and then open the cupboard to get a cup''. You would instead simply declare, make me some tea (please). Much like you declared print ``Hello World'' for me.

Unlike your friend a computer needs very precise step by step instructions to make tea. So let's look at two ways to provide this instruction. One without functions and another using functions.

Let's start by turning on our computer and asking it to boil some water for the tea.

First you need to get the kettle from your cupboard.This would involve going to the cupboard, opening it, and then pulling out the kettle from the cupboard and then closing the cupboard.

\includegraphics{assets/ch_3-functions/gifs/cupboard_steps.gif}

Now we need to take the kettle to the tap and fill enough water for a cup.

\includegraphics{assets/ch_3-functions/gifs/fill_water.gif}

Next let's give all the instructions to boil this water.

\includegraphics{assets/ch_3-functions/gifs/boil_water.gif}

Now that we have boiling water, we need to go back to the cupboard to get a cup to pour the water into.

\includegraphics{assets/ch_3-functions/gifs/get_cup.gif}

Now, the only thing missing is a tea bag. Let's go back to the cupboard to fetch that as well.

\includegraphics{assets/ch_3-functions/gifs/get_teabag.gif}

Now we need to place the teabag in the cup and pour the water in.

\includegraphics{assets/ch_3-functions/gifs/pour_water.gif}

Enjoy your tea!

\hypertarget{the-function-way}{%
\section{The function way}\label{the-function-way}}

Functions can be defined as follows \citep{function_def}

\begin{quote}
Functions are self contained modules of code that accomplish a specific task
\end{quote}

So how do we recognize when to use a function in our code???

The biggest hint that you can get for using a function is when you notice yourself copying and pasting code from one part of your script or notebook to another. This is usually a signal to stop and consider if it is worth the effort to encapsulate that particular sequence into a function. For instance, in our series of steps for the computer, the sequence where we go to the cupboard to fetch something is repeated and can be replaced with a function.

\includegraphics{assets/ch_3-functions/gifs/repetitions.gif}

Let's create a function called get\_item that takes the item that we would like to get from the cupboard as its argument. Notice how in the function definition, for step 3, where the computer needs to take a particular item, we use \texttt{item\_name} instead of a specific item like a kettle or a cup as we did previously. This is the key design feature of functions that allows us to use it repeatedly with different parameters.

\includegraphics{assets/ch_3-functions/gifs/get_item_fn.gif}

Now we can replace all the repeated cupboard sequences with our \texttt{get\_item()} function. And instead of the item\_name, we use the name of the specific item that we would like to fetch from the cupboard and internally the function will replace item\_name with the name of the item that we pass as an argument for the function. So get\_item(``cup'') will fetch a cup from the cupboard.

\includegraphics{assets/ch_3-functions/gifs/replace.gif}

Now that we have replaced the repeated sections, we can clean up our code a little bit. The code is now much smaller and easier to understand.
\includegraphics{assets/ch_3-functions/gifs/clean_code.gif}

\hypertarget{more-functions}{%
\section{More functions}\label{more-functions}}

Now imagine if you were instead teaching the computer to cook. And making tea was one of the many other things that are included in this huge program. Some of the sequences in making tea, such as that for boiling water or putting an item into a vessel etc. are also likely to be repeated elsewhere. How would you write a function to encapsulate these actions?

\hypertarget{the-magical-world-of-notebooks}{%
\chapter{The magical world of notebooks}\label{the-magical-world-of-notebooks}}

In \ref{setup} section on \protect\hyperlink{saving-code}{saving code} we wrote some code and saved it in an R Script file. Scripts are great for saving code that you would like to execute multiple number of times. They make it much easier to write and maintain code. But they have a limitation - they are not suited for interactively exploring data.

A significant portion of data science projects are spent exploring and making sense of the data. This can often require weaving text together with the code and its output. You would also want to share your work with your colleagues and being able to think out aloud in your documents while also presenting the code and its outputs makes your work easy to understand and replicate. Scripts don't allow us to do this effectively but notebooks do.

``An R Notebook is an R Markdown document with code chunks that can be executed independently and interactively, with output visible immediately beneath the input'' \citep{xie2019}. This chapter will explore the basic features of notebooks and how to use them.

\hypertarget{the-anatomy-of-a-notebook}{%
\section{The anatomy of a notebook}\label{the-anatomy-of-a-notebook}}

RStudio might ask you to install a few packages if this is the first time you are doing this. Go ahead and click yes.

\includegraphics{assets/ch_2-notebooks/gifs/open_notebook.gif}

As mentioned earlier, R notebooks are a type of R markdown document. This book for instance, is also written in R markdown and is a type of R markdown document. An R markdown document is composed of the following components.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{YAML}: At the top, we have a YAML header. YAML stands for Yet Another Markup Language. YAML is used to set the metadata for a R markdown document. For instance, here it sets the title of the notebook and specifies that the output format is an \texttt{html\_notebook}. The YAML portion of the document is identified by the three \texttt{-\/-\/-} at the top and bottom. You will not have to worry about YAML much in the beginning since RStudio conveniently pre-populates it when you open a new R markdown document. However, as you get along on your R journey, you will learn how to use this header section to customize the look and feel of your documents.
\item
  \textbf{Markdown}: The next piece of an R markdown document is markdown. Markdown is a text markup language. Markup is simply annotations next to text that instruct the editor to render the text a particular way. For instance, \texttt{\#\#} next to some text would indicate that the particular line of text should be rendered as a type 2 heading. This is similar to what you would do in a word processor where you would use the drop down to select a particular heading type. The only difference being that in an editor like MS Word the changes are instantaneously visible to the person who is writing, while with markdown you will only be able to see the changes when you render.
\item
  \textbf{Code}: You can insert new chunks of code into your notebooks using \texttt{Ctrl\ +\ Alt\ +\ I} or \texttt{CMD\ +\ Opt\ +\ I} in Mac. Whilw we will be primarily using R code, you could insert chunks of code in other languages like Python, C++, SQL also.
\end{enumerate}

\includegraphics{assets/ch_2-notebooks/gifs/notebook_anatomy.gif}

\hypertarget{the-basics}{%
\section{The basics}\label{the-basics}}

Give the document a name, hit save and preview it.

\includegraphics{assets/ch_2-notebooks/gifs/save_preview.gif}

The preview immediately launches the notebook in a different window showing the text along with the code.

Also notice, how the file section in R Studio now has two files. One that has the extension \texttt{.Rmd} indicating an R markdown file and another with the extension \texttt{.nb.html} indicating an HTML notebook, which is the output format that is in the YAML header.

\includegraphics{assets/ch_2-notebooks/gifs/two_files.gif}

Under the hood when you `knit' an Rmarkdown notebook it is handed off to the package knitr \citep{R-knitr} , which executes all the code chunks and spins up an intermediate markdown document. This document is then sent to a open source converter called pandoc that converts the markdown document to the format that is set in the YAML header. \citep{hadley2017}

\includegraphics{assets/ch_2-notebooks/gifs/first_preview.gif}

The preview updates whenever we make any changes to the notebook and save it. Let's see it in action. We can run a chunk of code by pressing the play button. This chunk of code generates a plot that is rendered below it. When we save the document and go back to the preview you will notice that it is automatically updated.

\includegraphics{assets/ch_2-notebooks/gifs/preview_updates.gif}

Let's update some markdown text as well to see how that renders. I am going to create a type one header. The number of \texttt{\#} indicate the level of a header in markdown. Once saved the preview will now show the title styled as type one heading.

\includegraphics{assets/ch_2-notebooks/gifs/title_updates.gif}

Let's add some more text for fun.

\includegraphics{assets/ch_2-notebooks/gifs/text_fun.gif}

If you click on the preview dropdown, you will also notice all these other output formats that you could knit into. Try out the pdf option.

\includegraphics{assets/ch_2-notebooks/gifs/pdf_doc.gif}

Keep this \href{https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf}{cheatsheet} as you use this book.

\hypertarget{packages}{%
\chapter{Packages}\label{packages}}

One of the biggest benefits of using an open source language like R is its robust package ecosystem. Now, if the only packages that you know of are the ones that get delivered by your mail person, then stick around. This chapter will cover how to install, use, uninstall and find packages. Let's start by understanding what packages are and why they are so great.

\hypertarget{what-is-a-package}{%
\section{What is a package?}\label{what-is-a-package}}

A package usually contains code, data and documentation.

\includegraphics{assets/packages/gifs/package_open.gif}

The code part usually contains a set of functions that we can use in our work. In Chapter \ref{functions-intro}, we discussed how functions allow us to encapsulate a series of operations. This function can then be repeatedly called to execute the same sequence of steps. Packages contain a collection of such functions that have been written and tested by someone else.

\includegraphics{assets/packages/gifs/package_fn.gif}

\hypertarget{why-are-packages-useful}{%
\section{Why are packages useful?}\label{why-are-packages-useful}}

Packages, can save us a tremendous amount of time and effort when conducting data analysis. Let's see how.

Imagine you are researching software stocks to invest in. You specifically want to examine past trends in price movement to predict the future.

\includegraphics{assets/packages/gifs/stock_qstn.gif}

To do this research, you will first need to download historical price data for different stocks from a website or service like Yahoo Finance or Morningstar.

\includegraphics{assets/packages/gifs/extract.gif}

Often, the downloaded data has errors, might be incomplete, and in a shape that is not suited for the analysis that you want to perform. So the first task is usually to tidy this data so that it is in a format that you can use. For instance, in the case shown below I transform the data from a wide format with stock names as columns to a long format where the stocks are represented as rows. There is a lot more to tidying data, which we will cover in chapter \ref{tidy-data}.

\includegraphics{assets/packages/gifs/tidy.gif}

The actual work that draws meaningful insight from the data often happens in an iterative manner. Very rarely do we find our answers in the first try and it often requires a series of steps that combine visualization, analysis and modeling and further transformations of the data till we can draw conclusions.

\includegraphics{assets/packages/gifs/make_sense.gif}

Once we have some conclusions that we can share, we can communicate these results. In a collaborative setting you would also need to communicate intermediate results with your research partner(s). So in these settings, communication can also be wrapped into the earlier iterative process of making sense of the data.

\includegraphics{assets/packages/gifs/communicate.gif}

Packages help simplify all of these steps. Most tasks and problems that you encounter in your analysis are likely to have already been resolved in a different setting by someone else. For instance, consider the task of getting data from Yahoo Finance, someone else has probably done this using R before. Packages are a way to bundle these solutions along with some documentation so that you don't have to reinvent the wheel when solving the same problems again.

For example, in our case, the \href{https://business-science.github.io/tidyquant/}{tidyquant} package contains a lot of functions for financial analysis. These can be used to directly download data from Yahoo Finance (or other sources), run popular financial models and visualize them. Similarly, other packages such as tidyr, ggplot, dplyr etc. provide general purpose tools and frameworks that can be applied to any data analysis project. And finally, packages like Rmarkdown and knitr make it really easy to communicate your results in a compelling manner in a wide variety of formats.

\includegraphics{assets/packages/gifs/package_use.gif}

In a world without packages, you would need to write all the code needed to perform every step of your analysis. This would mean, code to download the stock data, clean it up, custom code to create financial models that you want to use, code for the analysis itself, and generating the charts and tables to include in a report or presentation to communicate the results.

The bulk of your intellectual work should be on analyzing whether a stock is a good investment or not i.e.~making sense of the data. And packages free up your time by giving you well tested and effective solutions for tasks that are tangential to this purpose so that you can spend all your time on tasks that matter.

\hypertarget{package-repositories}{%
\section{Package Repositories}\label{package-repositories}}

Before we install a package, let's understand how they are maintained. When someone writes a package, they would need to host somewhere on the internet so that others can access the package to install it. The place that a package is hosted is called a repository. So when we issue a command on our computer to install a particular package, the relevant package is retrieved from this repository and installed on our computer.

\includegraphics{assets/packages/gifs/repo_concept.gif}

There are three main sources for r packages. The first and biggest one is the Comprehensive R Archive Network or CRAN. There are about 17500 packages on CRAN right now. The next one is called Bioconductor which specifically provides tools and packages for genomic data and analysis. The final category of packages are hosted independently with the most common choice being github which is a repository for code.

Packages that are hosted on CRAN or on BioConductor have requirements about testing and maintenance that ensures the quality of the code. These requirements do not exist for packages that are hosted independently on platforms like Github.

CRAN and Bioconductor require package developers to maintain their packages and pass certain quality checks. Packages that are not maintained are periodically removed from these repositories. Independently hosted packages such as those on Github on the other hand do not have to pass any sort of checks. Package developers often use github to release the most latest versions of their packages on Github before moving them to repositories like CRAN.

\includegraphics{assets/packages/gifs/3_repos.gif}

Most of the packages that we will use are hosted on CRAN (unless your work is on Genomics). It is also often the case that packages that are hosted on CRAN are also available on GitHub. These usually tend to be the most recent version of a particular package that has not fully tested but might include newer functions that are not in the previous version that is on CRAN.

\includegraphics{assets/packages/gifs/repo_last.gif}

\hypertarget{install-a-package}{%
\section{Install a package}\label{install-a-package}}

Our first installation will be the \texttt{cowsay} package. This is a pretty whimsical package that prints a particular animal saying a phrase that you specify. In the code below, I am using the function \texttt{say()} from the \texttt{cowsay} package with the arguments ``R can be pretty silly'' and cat. This is printed out as shown below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(cowsay)}
\FunctionTok{say}\NormalTok{(}\AttributeTok{what =} \StringTok{"R can be pretty silly"}\NormalTok{, }\AttributeTok{by =} \StringTok{"cat"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  -------------- 
## R can be pretty silly 
##  --------------
##     \
##       \
##         \
##             |\___/|
##           ==) ^Y^ (==
##             \  ^  /
##              )=*=(
##             /     \
##             |     |
##            /| | | |\
##            \| | |_|/\
##       jgs  //_// ___/
##                \_)
## 
\end{verbatim}

At the very minimum, packages that are published on CRAN must include an online reference that is in the pdf format. In a lot of cases, the package authors also provide additional reference websites and guides. In fact, the another package called \href{https://pkgdown.r-lib.org/}{\texttt{pkgdown}} provides tools and functions that make it really easy to build websites for packages. The \texttt{cowsay} package has a website that is built using \texttt{pkgdown}. You can access it \href{https://sckott.github.io/cowsay/}{here}.

\includegraphics{assets/packages/gifs/cowsay_scroll.gif}

Typically, the instructions to install a package are provided in the reference.

\includegraphics{assets/packages/gifs/install_box.gif}

As you can see, there are two suggested installation methods. The first is the version that is available on CRAN and the second is the newer development version from a repository on Github.

\hypertarget{tidy-data}{%
\chapter{Tidying Data}\label{tidy-data}}

TBD

  \bibliography{book.bib,packages.bib}

\end{document}
